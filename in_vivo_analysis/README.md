The `in_vivo_analysis/` contains code to analyse the _in vivo_ experiments we conducted to verify the predictions made by the movie-trained ViV1T, including low vs. high contrast centre-surround contextual modulation, generating MEIs and MEVs, etc., which are presented in **Figure 4**, **Figure 5** and **Supplemental Figure 3**.

- [check_cross_session_reliability.py](check_cross_session_reliability.py) compute the cross-session (day 1 vs. day 2/N) reliability. A subset of natural movies were presented on both sessions and we computed the response correlation between the two sessions for each matched neuron.
- [grating_contextual_modulation](grating_contextual_modulation/) verify the prediction that mouse V1 response to low and high contrast response changes the strength of their contextual modulation (**Figure 4B** to **4H**). Moreover, our model predicted that neurons change their contextual modulation preference between the two contrasts (**Figure 4I** and **4J**).
- [single_neuron_grating_vs_generated](single_neuron_grating_vs_generated) verify the single neuron response to grating vs. natural video vs. generated video (MEV) surround with centre of the stimulus fixed to the most-exciting grating (**Figure 5A** to **5D**).
- [single_neuron_static_vs_dynamic](single_neuron_static_vs_dynamic) verify the single neuron response to static vs. dynamic surround with centre of the stimulus fixed to the most-exciting natural image (**Figure 5E** to **5H**).
- [population_center_surround](population_center_surround) verify the population response to grating vs. natural video vs. generated video (MEV) surround with centre of the stimulus fixed to the most-exciting grating (**Supplemental Figure 3**).
